{% extends "shop/shop_base.html" %}
{% load static bootstrap4 %}
{% load render_table querystring from django_tables2 %}

{% block content_body %}
  <div class="container mt-2">
    {% if filter %}
      <div class="card card-body py-0 my-2">
        {{ filter.form.media }}
        <form action="." method="get" id="search_form">

          <div class="row">
            {% for field in filter.form.visible_fields %}
              <div class="col">
                {% bootstrap_field field %}
              </div>
            {% endfor %}

            <div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2">
              <div class="form-group">
                <label for="id_search">&nbsp;</label>
                <button class="form-control btn-primary " id="id_search" type="submit">
                  <i class="fas fa-filter"></i>&nbsp&nbsp Filter
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    {% endif %}

    <div class="card" id="table_tile">
      {% if heading %}<h4>{{ heading }}</h4>{% endif %}
      {% if actions %}
        <form action="." method="post">
          {% csrf_token %}
          <input type="hidden" name="query" value={% querystring without "page" "per_page" %}>
          <div class="row">
            <div class="col-6 col-md-4 col-lg-3 col-xl-2 pt-0 pb-1">
              <div class="pl-4">
                <input type="checkbox" id="select_all" name="select_all" value="Select all">
                <label class="pl-1" for="select_all">Select all</label>
              </div>
              <div class="pl-4">
                <input type="checkbox" id="select_all_page" value="Select page">
                <label class="pl-1" for="select_all_page">Select all on page</label>
              </div>
            </div>
            <div class="col-6 col-md-4 col-lg-3 col-xl-2 pt-2 pb-0">
              <span id="selected"><span id="count">0</span> of {{ table.rows|length }} rows selected</span>
            </div>
            <div class="col">
              <div class="dropdown">
                <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenu"
                        data-toggle="dropdown">
                  Select action
                </button>

                <div class="dropdown-menu">
                  {% for action in actions %}
                    <button class="dropdown-item" type="submit" name="{{ action.1 }}">{{ action.0 }}</button>
                  {% endfor %}
                </div>

                {% if buttons %}

                  {% for button in buttons %}
                    {% include '_button.html' %}
                  {% endfor %}
                {% endif %}
              </div>
            </div>
          </div>
          {% render_table table 'django_tables2/bootstrap4.html' %}
        </form>
      {% else %}
        <p>
          <button type="button" class="btn btn-primary js-create ml-2 mt-2">
            <span class="glyphicon glyphicon-plus"></span>
            New {{ object_name }}
          </button>
        </p>
        {% render_table table 'django_tables2/bootstrap4.html' %}
      {% endif %}

    </div>
    <div class="card" style="display:none;" id="id_loader">
      <p>Loading data ...</p>
    </div>
  </div>

  <!-- Modal to hold form -->
  <div class="modal fade " data-backdrop="static" data-keyboard="false" id="modal-form" role="dialog">
    <div class="modal-dialog {{ modal_class }}" role="document">
      <div class="modal-content bg-guest-light">
      </div>
    </div>
  </div>

  <!-- Modal to confirm -->
  <div class="modal fade" data-backdrop="static" data-keyboard="false" id="modal-confirm" role="dialog"
       style="top:250px;">
  <div class="modal-dialog" role="document">
    <div class="modal-content bg-warning">
      <div class="modal-body">
        <p>Are you sure?</p>
        <button type="button" class="btn btn-default" data-dismiss="modal" >Cancel</button>
        <button type="button" class="btn btn-danger js-delete" data-dismiss="modal">Delete</button>
      </div>
    </div>
  </div>

{% endblock %}
{% block custom_scripts %}
  <script src="{% static "shop/js/table_checkboxes.js" %}"></script>
{% endblock %}